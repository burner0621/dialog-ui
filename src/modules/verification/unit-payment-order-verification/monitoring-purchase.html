<template>

    <style>
        table>tbody>tr>td {
            white-space: pre;
        }
    </style>

    <h1 class="page-header">Monitoring Pembelian</h1>
    <form class="form-horizontal">
        <div class="form-group">
            <div class="col-sm-3"></div>
            <div class="col-sm-6">

                <au-textbox value.bind="purchaseOrder" label="Nomor PR" placeholder="nomor pr" read-only.bind="true">
                </au-textbox>

                <label for="contact" class="col-sm-9 control-label"></label>

            </div>
        </div>
        <div>
            <a click.delegate="exportToXls()" class='btn btn-primary'>Cetak Excel</a>
        </div>
        <div class="table-responsive">
            <table class="table table-bordered table-hover table-dark" border="1" id="poReport">
                <thead align="center">
                    <tr>
                        <td rowspan="3">NO</td>
                        <td colspan="2">PURCHASE REQUEST</td>
                        <td rowspan="3">KATEGORI</td>
                        <td rowspan="3">BUDGET</td>
                        <td rowspan="3">NAMA BARANG</td>
                        <td rowspan="3">KODE BARANG</td>
                        <td rowspan="3">JUMLAH</td>
                        <td rowspan="3">SATUAN</td>
                        <td colspan="2">HARGA</td>
                        <td colspan="2">SUPPLIER</td>
                        <td rowspan="3">TANGGAL TERIMA PO INTERN</td>
                        <td colspan="4">PO EXTERN</td>
                        <td colspan="3">SURAT JALAN</td>
                        <td colspan="4">BON PENERIMAAN</td>
                        <td rowspan="3">TEMPO PEMBAYARAN</td>
                        <td colspan="2">INVOICE</td>
                        <td colspan="4">NOTA INTERN (SPB)</td>
                        <td colspan="3">PPN</td>
                        <td colspan="3">PPH</td>
                        <td colspan="4">CATATAN KOREKSI</td>
                        <td rowspan="3">KETERANGAN</td>
                        <td rowspan="3">STATUS</td>
                    </tr>
                    <tr>
                        <td rowspan="2">TANGGAL</td>
                        <td rowspan="2">NOMOR</td>
                        <td rowspan="2">SATUAN</td>
                        <td rowspan="2">TOTAL</td>
                        <td rowspan="2">KODE</td>
                        <td rowspan="2">NAMA</td>
                        <td rowspan="2">TANGGAL</td>
                        <td rowspan="2">DIMINTA DATANG (PR)</td>
                        <td rowspan="2">TARGET DATANG</td>
                        <td rowspan="2">NOMOR</td>

                        <td rowspan="2">TANGGAL DATANG BARANG</td>
                        <td rowspan="2">TANGGAL</td>
                        <td rowspan="2">NOMOR</td>

                        <td rowspan="2">TANGGAL</td>
                        <td rowspan="2">NOMOR</td>
                        <td colspan="2">JUMLAH</td>

                        <td rowspan="2">TANGGAL</td>
                        <td rowspan="2">NOMOR</td>

                        <td rowspan="2">TANGGAL</td>
                        <td rowspan="2">NOMOR</td>
                        <td rowspan="2">NILAI</td>
                        <td rowspan="2">JATUH TEMPO</td>

                        <td rowspan="2">TANGGAL</td>
                        <td rowspan="2">NOMOR</td>
                        <td rowspan="2">NILAI</td>

                        <td rowspan="2">TANGGAL</td>
                        <td rowspan="2">NOMOR</td>
                        <td rowspan="2">NILAI</td>
                        <td rowspan="2">TANGGAL</td>
                        <td rowspan="2">NOMOR</td>
                        <td rowspan="2">NILAI</td>

                        <td rowspan="2">KET.</td>
                    </tr>
                    <tr>
                        <td>QTY</td>
                        <td>SAT</td>
                    </tr>
                </thead>
                <tbody>
                    <tr repeat.for="PO of data" class="${ PO.Position == 4 || PO.Position == 3 || PO.Position == 9 ?'success':PO.Position == 8 || PO.Position == 6 ?'danger':'primary'}">
                        
                        <td>${PO.InternalPurchaseOrderNo}</td>
                        <td>${PO.PurchaseRequestDate}</td>
                        <td>${PO.PurchaseRequestNo}</td>
                        <td>${PO.CategoryName}</td>
                        <td>${PO.BudgetName}</td>
                        <td>${PO.ProductName}</td>
                        <td>${PO.ProductCode}</td>
                        <td align="right">${(PO.OrderQuantity).toLocaleString()}</td>
                        <td>${PO.UOMUnit}</td>
                        <td align="right">${(PO.Price).toLocaleString()}</td>
                        <td align="right">${(PO.PriceTotal).toLocaleString()}</td>
                        <td>${PO.SupplierCode}</td>
                        <td>${PO.SupplierName}</td>
                        <td>${PO.InternalPurchaseOrderCreatedDate}</td>
                        <td>${PO.ExternalPurchaseOrderCreatedDate}</td>
                        <td>${PO.PurchaseRequestDate}</td>
                        <td>${PO.ExternalPurchaseOrderExpectedDeliveryDate}</td>
                        <td>${PO.ExternalPurchaseOrderNo}</td>
                        <td>${PO.DeliveryOrderDate}</td>
                        <td>${PO.DeliveryOrderArrivalDate}</td>
                        <td>${PO.DeliveryOrderNo}</td>
                        <td>${PO.UnitReceiptNoteDate}</td>
                        <td>${PO.UnitReceiptNoteNo}</td>
                        <td>${PO.UnitReceiptNoteQuantity}</td>
                        <td>${PO.UnitReceiptNoteUomUnit}</td>
                        <td>${PO.ExternalPurchaseOrderPaymentDueDays}</td>
                        <td>${PO.UnitPaymentOrderInvoiceDate}</td>
                        <td>${PO.UnitPaymentOrderInvoiceNo}</td>
                        <td>${PO.UnitPaymentOrderDate}</td>
                        <td>${PO.UnitPaymentOrderNo}</td>
                        <td>${PO.UnitPaymentOrderTotalPrice.toLocaleString()}</td>
                        <td>${PO.UnitPaymentOrderDueDate}</td>
                        <td>${PO.UnitPaymentOrderVATDate}</td>
                        <td>${PO.UnitPaymentOrderVATNo}</td>
                        <td>${PO.UnitPaymentOrderVAT.toLocaleString()}</td>
                        <td>${PO.UnitPaymentOrderIncomeTaxDate}</td>
                        <td>${PO.UnitPaymentOrderIncomeTaxNo}</td>
                        <td>${PO.UnitPaymentOrderIncomeTax.toLocaleString()}</td>
                        <td>${PO.CorrectionDate}</td>
                        <td>${PO.CorrectionNo}</td>
                        <td>${PO.CorrectionNominal}</td>
                        <td>${PO.CorrectionType}</td>
                        <td>${PO.ExternalPurchaseOrderRemark}</td>
                        <td>${PO.InternalPurchaseOrderStatus}</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="alert alert-info text-center" role="alert" if.bind="data.length == 0">
            Tidak ada data ditemukan.
        </div>
        <div>
            * Baris warna merah : telah di kirim ke bagian Pembelian (not verified)
            <br> * Baris warna hijau : telah di kirim ke bagian Kasir atau Accounting (verified)
        </div>
        <hr/>
    </form>
</template>